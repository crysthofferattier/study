#!/usr/bin/python

import socket
import sys

def check_arguments():
	if len(sys.argv) < 2:
		print("Missing argument")
		print("Usage: " + sys.argv[0] + " [host domain/host IP]")
		print("Example: " + sys.argv[0] + " www.example.com/200.99.99.1")
		exit()


def print_ftpenum_banner():
	print("FTPEnum")
	print("Default port: 21")


def enum(host):
	sck = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	sck.connect((host, 21))
	rsp = str(sck.recv(1024))

	print(rsp)

	print("USER anonymous\r\n")
	sck.send("USER anonymous\r\n")
	rsp = str(sck.recv(1024))

	print(rsp)

	print("PASS anonymous\r\n")
	sck.send("PASS anonymous\r\n")
	rsp = str(sck.recv(1024))

	print(rsp)


def main():
	check_arguments()
	print_ftpenum_banner()

	host = sys.argv[1]

	enum(host)


main()