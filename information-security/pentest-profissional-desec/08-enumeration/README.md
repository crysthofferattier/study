# 08 - Enumeration

## 01. - Banner Grabbing HTTP

### Netcat 

> root@kali:~# nc -v [host domain] 80

#### Full page

```
root@kali:~# nc -v www.example.com 80
Connection to www.example.com 80 port [tcp/http] succeeded!
GET / HTTP/1.0
Host: www.example.com

HTTP/1.1 200 OK
Date: Thu, 22 Oct 2015 04:30:52 GMT
Server: Apache/2.2.22 (Debian)
Last-Modified: Tue, 13 Oct 2015 18:27:58 GMT
ETag: "20463-1b79-522009aede4a5"
Accept-Ranges: bytes
Content-Length: 7033
Vary: Accept-Encoding
Connection: close
Content-Type: text/html

<!DOCTYPE html>
<!--[if lt IE 8 ]><html class="no-js ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="no-js ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 8)|!(IE)]><!--><html class="no-js" lang="en"> <!--<![endif]-->
<head>

								...
```

#### HEAD

```
root@kali:~# nc -v www.example.com 80
Connection to www.example.com 80 port [tcp/http] succeeded!
HEAD / HTTP/1.0
Host: www.example.com

HTTP/1.1 200 OK
Date: Thu, 22 Oct 2015 04:32:13 GMT
Server: Apache/2.2.22 (Debian)
Last-Modified: Tue, 13 Oct 2015 18:27:58 GMT
ETag: "20463-1b79-522009aede4a5"
Accept-Ranges: bytes
Content-Length: 7033
Vary: Accept-Encoding
Connection: close
Content-Type: text/html
```

## 02. - Banner Grabbing HTTPs

### Openssl

> root@kali:~# openssl s_client -quiet -connect [host domain]

#### HEAD

```
root@kali:~# openssl s_client -quiet -connect www.example.com:443
HEAD / HTTP/1.0
Host:www.example.com

HTTP/1.0 200 OK
Last-Modified: Wed, 14 Mar 2018 22:25:05 GMT
ETag: "42f66-f0c9-56766d8ca1240"
Content-Type: text/html
Date: Fri, 16 Mar 2018 00:00:22 GMT
Connection: close
Access-Control-Allow-Methods: GET, POST
Access-Control-Allow-Origin: internet.example.com
```

#### Full page

```
root@kali:~# openssl s_client -quiet -connect www.example.com:443
GET / HTTP/1.0
Host:www.example.com

HTTP/1.0 200 OK
Last-Modified: Wed, 14 Mar 2018 22:25:05 GMT
ETag: "42f66-f0c9-56766d8ca1240"
Content-Type: text/html
Date: Fri, 16 Mar 2018 00:00:22 GMT
Connection: close
Access-Control-Allow-Methods: GET, POST
Access-Control-Allow-Origin: internet.example.com

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-br" xml:lang="pt-br" class="no-js">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=10;requiresActiveX=true">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="language" content="pt-br" />

								...
```

## 03. - FTP Enumeration

### Find FTP port

> root@kali:~# nmap -v -sS [host domain]

```
root@kali:~# nmap -v -sS www.example.com
```

### Connect

#### Netcat

> root@kali:~# nc -v [host domain/host IP] [port]

```
root@kali:~# nc -v www.example.com 21
Connection to www.example.com 21 port [tcp/ftp] succeeded!
220 ProFTPD 1.3.4a Server (FTP) [::ffff:37.59.174.225]
```


#### FTP Client

> root@kali:~# ftp [host address/host IP]

```
root@kali:~# ftp www.example.com
Connected to www.example.com.
220 ProFTPD 1.3.4a Server (FTP) [::ffff:37.59.174.225]
Name (www.example.com:user): 
```

#### User/Password

* anonymous
* ftp

### FTPEnum

##### [ftpenum.py](#)

## 04. - Netbios e SMB

### Netbios | Server Message Block.
* Port: 
	* 139 (netbios)
	* 445 (smb)
* **Null Session**: session without authentication
* **IPC$**: Anonymous users execution


### Find Netbios/SMB ports

> root@kali:~# nmap -v --open -sS -Pn -p [port] [host]

```
root@kali:~# nmap -v --open -sS -Pn -p 139,445 200.99.99.1
```

## 05. - SMB/Netbios Enumeration (Windows)

### Windows machine

#### nbtstat

> C:\Users\Pentest> nbtstat -A [host IP]

```
C:\Users\Pentest> nbtstat
C:\Users\Pentest> nbtstat -A 172.16.1.5
```

### Null session

#### net use

> C:\Users\Pentest> net use [host ip] [passwd] [user]

* "": password
* /u: user

```
C:\Users\Pentest> net use \\172.16.1.4 "" /u:""
Successful
C:\Users\Pentest> net use \\172.16.1.5 "" /u:""
Successful
```

> C:\Users\Pentest> net use

```
C:\Users\Pentest> net use
New connections will be remembered

Status		Local 		Remoto				Network
OK				\\172.16.1.4\IPC$		Microsoft Windows Network
OK				\\172.16.1.5\IPC$		Microsoft Windows Network
						...
```

> C:\Users\Pentest> net view [host ip]

```
C:\Users\Pentest> net view \\172.16.1.4
System error

C:\Users\Pentest> net view \\172.16.1.5
Shared resources at \\172.16.1.5

metasploitable server (Samba 3.0.20-Debian)

Share Name 		Type 		Used as ...
------------------------------------------------------------------------
opt 			...
tmp 			...
```

> C:\Users\Pentest> net use [partition] [host ip]\\[share name]

```
C:\Users\Pentest> net use x: \\172.16.1.5\tmp
C:\Users\Pentest> net use
New connections will be remembered

Status		Local 		Remoto				Network
OK		x:		\\172.16.1.5\tmp		Microsoft Windows Network
OK				\\172.16.1.4\IPC$		Microsoft Windows Network
OK				\\172.16.1.5\IPC$		Microsoft Windows Network
```

### Default authentication

> C:\Users\Pentest> net use [host ip] [passwd] [user]

* "": password
* /u: user

```
C:\Users\Pentest> net use \\172.16.1.4 /delete
C:\Users\Pentest> net use \\172.16.1.4 "" /u:adminitrator
Successful
C:\Users\Pentest> net use
							...
C:\Users\Pentest> net view \\172.16.1.4
Shared resources at \\172.16.1.4
							...
C:\Users\Pentest> net use r: \\172.16.1.4\_DOCS
							...

Partition in "Explorer"
C:\Users\Pentest> r:
R:\> dir
							...
```

## 05. - SMB/Netbios Enumeration (Linux)

### Map

```
root@kali:~# nbtscan 172.16.1.0/24
Doing NBT name scan for addresses from 192.168.0.1/24

IP address       NetBIOS Name     Server    User             MAC address      
------------------------------------------------------------------------------
192.168.0.0	Sendto failed: Permission denied
192.168.0.103    <unknown>                  <unknown>        
192.168.0.104    METASPLOITABLE   <server>  METASPLOITABLE   00:00:00:00:00:00
						...
```

### Smbclient

>root@kali:~#  smbclient -L //[host address] -N

* -N: no passwd
* -L: list host
* -U: user

```
root@kali:~# smbclient -L //172.16.1.4 -N
WARNING: The "syslog" option is deprecated
Anonymous login successful
						...
```

```
root@kali:~# smbclient -L //172.16.1.4 -N -U administrator
WARNING: The "syslog" option is deprecated
Anonymous login successful
						...
root@kali:~# smbclient  //192.168.0.104/tmp -N
WARNING: The "syslog" option is deprecated
Anonymous login successful
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Sat Mar 17 14:58:31 2018
  ..                                 DR        0  Sun May 20 14:36:12 2012
  .ICE-unix                          DH        0  Sat Mar 17 14:48:48 2018
  .X11-unix                          DH        0  Sat Mar 17 14:49:07 2018
  .X0-lock                           HR       11  Sat Mar 17 14:49:07 2018
  4411.jsvc_up                        R        0  Sat Mar 17 14:49:17 2018
  						...
```

## 06. - Rcpclient

```
root@kali:~# rpcclient -U "" -N 192.168.0.104
rpcclient $> ? (list support commands)
```

## 07. - enum4linux

> root@kali:~# enum4linux -a [host address]

* **-a**: Do all simple enumeration (-U -S -G -P -r -o -n -i).
              This opion is enabled if you don't provide any other options.

* **-u**: user
* **-p**: passwd

```
root@kali:~# enum4linux -a 10.0.0.3
root@kali:~# enum4linux -a -u administrator -p "" 10.0.0.2
```

## 08. - Nmap SNE

> root@kali:~# ls /usr/share/nmap/scripts/smb*

> root@kali:~# nmap -v --script=smb-os-discovery [host address]

```
root@kali:~# nmap -v --script=smb-os-discovery 192.168.0.104
root@kali:~# nmap -v --script=smb-enum-shares 192.168.0.104
root@kali:~# nmap -v --script=smb* 192.168.0.104
```

## 09. - SMTP Enum

```
root@kali:~# nmap -v --open -p 25 -Pn 192.168.0.1/24
root@kali:~# nc -vn 192.168.0.104 25
VRFY root
```

## 10. 11. - SMTP Python

##### [smtp-enum.py](#)

## 12. - SNMP Enum

### SNMP

Simple Network Mangement Protocol
* Port: 161 (**UDP**)

### MIB

Management Information Base

| - | - |
| - | - |
| 1.3.6.1.2.1.25.1.6.0  | System Processes |
| 1.3.6.1.2.1.25.4.2.1.2 | Running Programs |
| 1.3.6.1.2.1.25.4.2.1.4 | Processes Path |
| 1.3.6.1.2.1.25.2.3.1.4 | Storage Units |
| 1.3.6.1.2.1.25.6.3.1.2 | Software Name |
| 1.3.6.1.4.1.77.1.2.25 | User Accounts |
| 1.3.6.1.2.1.6.13.1.3	| TCP Local Ports |

### Community

* public
* private
* manager

```
root@kali:~# nmap -v --open -sUV -p161 -Pn [host]
```

## 12. - SNMP Enum (Pt. 02)

> root@kali:~# 

```
root@kali:~# echo public >> community.txt
root@kali:~# echo private >> community.txt
root@kali:~# echo manager >> community.txt

root@kali:~# for ip in $(seq 1 254);do echo [host].$ip;done > ips
```

> root@kali:~# onesixtyone -c [community-list] -i [hosts]

```
root@kali:~# onesixtyone -c community.txt -i ips
```

> root@kali:~# snmpwalk -c [community] -v1 [host] [mib]

```
root@kali:~# snmpwalk -c public -v1 10.0.0.1 1.3.6.1.2.1.25.1.6.0
```

> root@kali:~# snmp-check -t [host]

```
root@kali:~# snmp-check -t 10.0.0.1
```

## 13. - MySQL Enum

```
root@kali:~# nmap -v --open -sS -p 3306 192.168.0.1/24
```

> root@kali:~# mysql -h [host] -u [user]

```
root@kali:~# mysql -h 10.0.0.1 -u root
```